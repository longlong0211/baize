<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue CLI 3 Preset Web 项目骨架开发小结 | 白泽 说明文档</title>
    <meta name="description" content="">
    <link rel="icon" href="./favicon.ico">
    
    <link rel="preload" href="/baize/assets/css/0.styles.cc700561.css" as="style"><link rel="preload" href="/baize/assets/js/app.f3b3f261.js" as="script"><link rel="preload" href="/baize/assets/js/3.698506f3.js" as="script"><link rel="prefetch" href="/baize/assets/js/2.db3585a0.js"><link rel="prefetch" href="/baize/assets/js/4.c7eda6a0.js">
    <link rel="stylesheet" href="/baize/assets/css/0.styles.cc700561.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/baize/" class="home-link router-link-exact-active router-link-active"><!----> <span class="site-name">白泽 说明文档</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/121595113/baize" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"> <a href="https://github.com/121595113/baize" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Vue CLI 3 Preset Web 项目骨架开发小结</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/baize/#vue-cli-3-基本认识" class="sidebar-link">Vue CLI 3 基本认识</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/baize/#vue-cli" class="sidebar-link">@vue/cli</a></li><li class="sidebar-sub-header"><a href="/baize/#vue-cli-service" class="sidebar-link">@vue/cli-service</a></li></ul></li><li><a href="/baize/#preset-项目开发" class="sidebar-link">Preset 项目开发</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/baize/#使用-preset-初始化项目特点" class="sidebar-link">使用 preset 初始化项目特点</a></li><li class="sidebar-sub-header"><a href="/baize/#preset-项目的结构" class="sidebar-link">preset 项目的结构</a></li><li class="sidebar-sub-header"><a href="/baize/#preset-项目的调试" class="sidebar-link">preset 项目的调试</a></li></ul></li><li><a href="/baize/#问题记录" class="sidebar-link">问题记录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/baize/#_1、如何从任意-git-仓库获取-remote-preset-初始化项目" class="sidebar-link">1、如何从任意 git 仓库获取 remote preset 初始化项目</a></li><li class="sidebar-sub-header"><a href="/baize/#_2、preset-项目如何配置-eslint" class="sidebar-link">2、preset 项目如何配置 eslint</a></li><li class="sidebar-sub-header"><a href="/baize/#_3、browserlist-有什么作用，如何正确配置-browserlist" class="sidebar-link">3、browserlist 有什么作用，如何正确配置 browserlist</a></li><li class="sidebar-sub-header"><a href="/baize/#_4、如何删除-vue-cli3-创建的默认目录或文件" class="sidebar-link">4、如何删除 vue-cli3 创建的默认目录或文件</a></li><li class="sidebar-sub-header"><a href="/baize/#_5、如何让-vue-cli3-使用项目模板的-readme-md" class="sidebar-link">5、如何让 vue-cli3 使用项目模板的 README.md</a></li><li class="sidebar-sub-header"><a href="/baize/#_6、preset-项目如何将配置保存成单个文件，而不是包含在-package-json" class="sidebar-link">6、preset 项目如何将配置保存成单个文件，而不是包含在 package.json</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="vue-cli-3-preset-web-项目骨架开发小结"><a href="#vue-cli-3-preset-web-项目骨架开发小结" class="header-anchor">#</a> Vue CLI 3 Preset Web 项目骨架开发小结</h1> <h2 id="vue-cli-3-基本认识"><a href="#vue-cli-3-基本认识" class="header-anchor">#</a> Vue CLI 3 基本认识</h2> <blockquote><p><a href="https://cli.vuejs.org/zh/guide/" target="_blank" rel="noopener noreferrer">官网文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://github.com/yuezhilunhui2009/vue-cli3-preset-seed" target="_blank" rel="noopener noreferrer">参考链接<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <h3 id="vue-cli"><a href="#vue-cli" class="header-anchor">#</a> @vue/cli</h3> <p>用于交互式搭建基于 vue 技术栈项目的工具，通常安装在全局 node_module 中。它提供的命令主要有以下几个：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 用于创建项目</span>
vue create

<span class="token comment"># 启动 VUE GUI</span>
vue ui

<span class="token comment"># 部分 vue [command] 的命令实际是 @vue/cli-service 提供的</span>
vue inspect

<span class="token comment"># 部分 vue [command] 的命令实际是 @vue/cli-service-global 提供的</span>
vue serve
vue build
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">提示</p> <p>在开发一个 preset 项目时通常关注 <code>vue create</code> 和 <code>vue inspect</code> 命令。</p></div> <h3 id="vue-cli-service"><a href="#vue-cli-service" class="header-anchor">#</a> @vue/cli-service</h3> <p>用于本地开发以及编译打包，提供的命令主要是：</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 本地开发调试</span>
vue-cli-service serve

<span class="token comment"># 打包编译</span>
vue-cli-service build

<span class="token comment"># 检查 webpack 最终配置</span>
vue-cli-service inspect

<span class="token comment"># 代码书写格式检查</span>
vue-cli-service lint
</code></pre></div><h2 id="preset-项目开发"><a href="#preset-项目开发" class="header-anchor">#</a> Preset 项目开发</h2> <p>一个 Vue CLI preset 是一个包含创建新项目所需预定义选项和插件的 JSON 对象，让用户无需在命令提示中选择它们。</p> <p>官方 preset 示例：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;useConfigFiles&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>...<span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;router&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;vuex&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;cssPreprocessor&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sass&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;configs&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;vue&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>...<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;postcss&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>...<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;eslintConfig&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>...<span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;jest&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>...<span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用-preset-初始化项目特点"><a href="#使用-preset-初始化项目特点" class="header-anchor">#</a> 使用 preset 初始化项目特点</h3> <ul><li>可以预设项目的 vue-plugin-xxx</li> <li>可以预设 router、vuex</li> <li>可以预设 cssPreprocessor</li> <li>可以预设 vue.config.js</li> <li>可以开启或者关闭插件的 prompts</li> <li>可以提供一套文件目录结构</li> <li>可以执行 <a href="https://cli.vuejs.org/zh/dev-guide/plugin-dev.html#generator" target="_blank" rel="noopener noreferrer">Generator<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 和 <a href="https://cli.vuejs.org/zh/dev-guide/plugin-dev.html#%E7%AC%AC%E4%B8%89%E6%96%B9%E6%8F%92%E4%BB%B6%E7%9A%84%E5%AF%B9%E8%AF%9D" target="_blank" rel="noopener noreferrer">Prompt<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>preset 可以是本地或者远程项目</li></ul> <h3 id="preset-项目的结构"><a href="#preset-项目的结构" class="header-anchor">#</a> preset 项目的结构</h3> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token builtin class-name">.</span>
├── README.md
├── projectTemplate
├── generator.js  <span class="token comment"># generator (可选)</span>
├── prompts.js    <span class="token comment"># prompt 文件 (可选)</span>
├── index.js      <span class="token comment"># service 插件</span>
└── package.json
</code></pre></div><h3 id="preset-项目的调试"><a href="#preset-项目的调试" class="header-anchor">#</a> preset 项目的调试</h3> <p>通过引用本地 preset 创建项目的方式进行代码调试</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ./my-preset 应当是一个包含 preset.json 的文件夹</span>
vue create --preset ./my-preset my-project

<span class="token comment"># 或者，直接使用当前工作目录下的 json 文件：</span>
vue create --preset my-preset.json my-project
</code></pre></div> <h2 id="问题记录"><a href="#问题记录" class="header-anchor">#</a> 问题记录</h2> <h3 id="_1、如何从任意-git-仓库获取-remote-preset-初始化项目"><a href="#_1、如何从任意-git-仓库获取-remote-preset-初始化项目" class="header-anchor">#</a> 1、如何从任意 git 仓库获取 remote preset 初始化项目</h3> <h4 id="背景"><a href="#背景" class="header-anchor">#</a> 背景</h4> <ul><li>获取远程 preset 说明包含 github、gitlab、bitbucket 三个云仓库；</li> <li>尝试直接在 --preset 后填写完整 url 直接报 404 或 auth 相关错误；</li> <li>添加 --clone 参数后报 'git clone' failed with status 128 错误；</li></ul> <h4 id="解决方案"><a href="#解决方案" class="header-anchor">#</a> 解决方案</h4> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># 关键点：</span>
<span class="token comment"># 1. 在 git 仓库 url 前添加 &quot;direct:&quot;</span>
<span class="token comment"># 2. 添加 --clone 参数</span>
vue create --preset direct:https://github.com/121595113/baize.git --clone preset-seed-demo
</code></pre></div><h4 id="解决过程"><a href="#解决过程" class="header-anchor">#</a> 解决过程</h4> <ol><li>打开全局 node_modules/@vue/cli 扫一眼目录结构，从 bin 目录找到 <code>vue create --preset</code> 入口；</li> <li>根据入口代码发现调用链 <a href="https://github.com/vuejs/vue-cli/blob/dev/packages/%40vue/cli/bin/vue.js" target="_blank" rel="noopener noreferrer">bin/vue<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> -&gt; <a href="https://github.com/vuejs/vue-cli/blob/dev/packages/%40vue/cli/lib/create.js" target="_blank" rel="noopener noreferrer">lib/create<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> -&gt; <a href="https://github.com/vuejs/vue-cli/blob/dev/packages/%40vue/cli/lib/Creator.js" target="_blank" rel="noopener noreferrer">lib/Creator<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> -&gt; <a href="https://github.com/vuejs/vue-cli/blob/dev/packages/%40vue/cli/lib/util/loadRemotePreset.js" target="_blank" rel="noopener noreferrer">util/loadRemotePreset<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> -&gt; <a href="https://www.npmjs.com/package/download-git-repo" target="_blank" rel="noopener noreferrer">download-git-repo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>；</li> <li>最终看到 vue-cli3 使用了 <a href="https://www.npmjs.com/package/download-git-repo" target="_blank" rel="noopener noreferrer">download-git-repo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 这个 npm 包；</li> <li>回头看看 <code>vue create --preset &lt;url/gitRepoName&gt;</code> 命令参数的传递过程发现 url 是透传到 <a href="https://www.npmjs.com/package/download-git-repo" target="_blank" rel="noopener noreferrer">download-git-repo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 的；</li> <li>根据 <a href="https://www.npmjs.com/package/download-git-repo" target="_blank" rel="noopener noreferrer">download-git-repo<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 文档我们直接使用 Direct + clone 模式；</li> <li>反映到 vue create --preset 这边就是 <code>vue create --preset direct:&lt;git url&gt;&lt;/git&gt; --clone &lt;projectName&gt;</code></li></ol> <h3 id="_2、preset-项目如何配置-eslint"><a href="#_2、preset-项目如何配置-eslint" class="header-anchor">#</a> 2、preset 项目如何配置 eslint</h3> <h4 id="背景-2"><a href="#背景-2" class="header-anchor">#</a> 背景</h4> <ul><li>preset 项目可以在 preset.json 中配置 eslint 插件，例如：@vue/cli-plugin-eslint；</li> <li>preset 项目可以在 generator/index.js 中配置 eslint 相关依赖及配置；</li> <li>两种配置是否会冲突，比较晕；</li></ul> <h4 id="结论"><a href="#结论" class="header-anchor">#</a> 结论</h4> <ul><li>preset.json 中添加 @vue/cli-plugin-eslint 这个插件带来的是 eslint 整套配置，包含依赖、rule、githook；</li> <li>generator/index.js 中配置 eslint 主要通过自己改写 package.json 以及 eslintConfig 内容来配置 eslint，每一处都需要自己写；</li> <li>preset.json 与 generator/index.js 的配置可能会产生冲突，例如对 eslintConfig rules 进行配置，如果配置项是数组，那么最终创建的项目里此项会合并两处配置，导致配置错误；</li></ul> <h3 id="_3、browserlist-有什么作用，如何正确配置-browserlist"><a href="#_3、browserlist-有什么作用，如何正确配置-browserlist" class="header-anchor">#</a> 3、browserlist 有什么作用，如何正确配置 browserlist</h3> <h4 id="背景-3"><a href="#背景-3" class="header-anchor">#</a> 背景</h4> <ul><li>在使用多种项目脚手架都看到过 browserlist，经常看到这样的默认配置：</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>last <span class="token number">1</span> version
<span class="token operator">&gt;</span> <span class="token number">1</span>%
</code></pre></div><h4 id="结论-2"><a href="#结论-2" class="header-anchor">#</a> 结论</h4> <ul><li>browserlist 作用于以下工具：
<ul><li>Autoprefixer</li> <li>Babel</li> <li>postcss-preset-env</li> <li>eslint-plugin-compat</li> <li>stylelint-no-unsupported-browser-features</li> <li>postcss-normalize</li></ul></li> <li>可以使上面列表中的工具针对特定版本区间的浏览器生成对应的兼容性代码；</li> <li><a href="https://cli.vuejs.org/zh/guide/browser-compatibility.html#browserslist" target="_blank" rel="noopener noreferrer">vue-cli3 中有 @babel/preset-env 和 Autoprefixer 会用到 browserlist 配置<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>；</li> <li>browserlist 配置参考：
<ul><li><a href="https://github.com/browserslist/browserslist" target="_blank" rel="noopener noreferrer">https://github.com/browserslist/browserslist<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>与 browserlist 配合的工具配置参考：
<ul><li><a href="https://github.com/browserslist/browserslist-example" target="_blank" rel="noopener noreferrer">https://github.com/browserslist/browserslist-example<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>一个在线工具，用于查看 browserlist 配置文件匹配到哪些浏览器：
<ul><li><a href="https://browserl.ist/?q=defaults" target="_blank" rel="noopener noreferrer">https://browserl.ist/?q=defaults<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li>注意：并不是项目中所有依赖都支持低版本浏览器，例如 vue 本身不支持低于 IE9 的浏览器；</li></ul> <h3 id="_4、如何删除-vue-cli3-创建的默认目录或文件"><a href="#_4、如何删除-vue-cli3-创建的默认目录或文件" class="header-anchor">#</a> 4、如何删除 vue-cli3 创建的默认目录或文件</h3> <h4 id="背景-4"><a href="#背景-4" class="header-anchor">#</a> 背景</h4> <ul><li>自己编写的 preset 有一套自定义目录结构，但是 vue-cli3 创建项目后总会有一些默认结构：</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>/public
/src/main.js
/src/App.vue
/src/components/HelloWorld.vue
</code></pre></div><h4 id="结论-3"><a href="#结论-3" class="header-anchor">#</a> 结论</h4> <ul><li>在 /generator/index.js 中利用 <a href="https://github.com/vuejs/vue-cli/blob/dev/packages/%40vue/cli/lib/GeneratorAPI.js" target="_blank" rel="noopener noreferrer">GeneratorAPI<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 进行目录文件编辑：</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// generator</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">api<span class="token punctuation">,</span> options<span class="token punctuation">,</span> rootOptions</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 删除 vue-cli3 默认的 /src 和 /public 目录</span>
  api<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">files</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>files<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">path</span> <span class="token operator">=&gt;</span> path<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'src/'</span><span class="token punctuation">)</span> <span class="token operator">||</span> path<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'public/'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">path</span> <span class="token operator">=&gt;</span> <span class="token keyword">delete</span> files<span class="token punctuation">[</span>path<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// 根据自定义模板生成项目结构</span>
  api<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'./template'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5、如何让-vue-cli3-使用项目模板的-readme-md"><a href="#_5、如何让-vue-cli3-使用项目模板的-readme-md" class="header-anchor">#</a> 5、如何让 vue-cli3 使用项目模板的 README.md</h3> <h4 id="结论-4"><a href="#结论-4" class="header-anchor">#</a> 结论</h4> <ul><li>在 /generator/index.js 中修改环境变量:</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 屏蔽 generator 之后的文件写入操作</span>
api<span class="token punctuation">.</span><span class="token function">onCreateComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">VUE_CLI_SKIP_WRITE</span> <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>目的是令 writeFileTree 函数不写文件直接退出，这样 vue-cli3 在写 README.md 时会直接跳过。</p> <h3 id="_6、preset-项目如何将配置保存成单个文件，而不是包含在-package-json"><a href="#_6、preset-项目如何将配置保存成单个文件，而不是包含在-package-json" class="header-anchor">#</a> 6、preset 项目如何将配置保存成单个文件，而不是包含在 package.json</h3> <h4 id="结论-5"><a href="#结论-5" class="header-anchor">#</a> 结论</h4> <ul><li>在 preset.json 中修改变量：</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code>useConfigFiles: <span class="token boolean">true</span>
</code></pre></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/baize/assets/js/app.f3b3f261.js" defer></script><script src="/baize/assets/js/3.698506f3.js" defer></script>
  </body>
</html>
